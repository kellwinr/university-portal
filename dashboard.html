<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>UTAR Portal â€” Dashboard (Demo)</title>
  <link rel="icon" href="assets/img/utar-favicon.png" />
  <link rel="stylesheet" href="assets/css/styles.css" />
</head>
<body>

  <!-- ===== Header (Two-row) ===== -->
  <header class="tworow" role="banner">
    <!-- Row 1: Logo -->
    <div class="logo-section">
      <img class="brand-logo" src="assets/img/Universiti_Tunku_Abdul_Rahman_Logo.jpg" alt="UTAR Logo" />
      <div class="logo-text">
        <strong>UNIVERSITI TUNKU ABDUL RAHMAN</strong>
        <small>University Portal (Demo)</small>
      </div>
    </div>

    <!-- Row 1: Utilities -->
    <div class="top-utils">
      <form class="portal-search" role="search" onsubmit="return false;" aria-label="Search">
        <input type="search" placeholder="Search subjects, lecturers, announcementsâ€¦" />
      </form>

      <button class="icon-btn bell" aria-label="Notifications">
        <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" fill="none" stroke-width="1.8" aria-hidden="true">
          <path d="M15 17h5l-1.4-1.4A2 2 0 0 1 18 14.2V11a6 6 0 1 0-12 0v3.2c0 .5-.2 1-.6 1.4L4 17h5"/>
          <path d="M9 17a3 3 0 0 0 6 0"/>
        </svg>
        <span class="badge" id="notifBadge">3</span>
      </button>

      <span class="id-chip" id="chipId" aria-label="Student ID">ID: â€”</span>

      <div class="menu-item">
        <a href="#" class="avatar-trigger pill" aria-haspopup="true" aria-expanded="false" style="padding:0;border:none;background:transparent;">
          <img class="avatar" src="assets/img/avatar-student.png" alt="Profile" />
        </a>
        <div class="dropdown" id="dropdownProfile">
          <a href="#">Profile &amp; Settings</a>
          <a href="#">My Documents</a>
          <a href="#">Security</a>
          <a href="#" id="logout">Sign out</a>
        </div>
      </div>
    </div>

    <!-- Row 2: Nav -->
    <nav class="menu-bar" aria-label="Primary">
      <a class="pill is-active" href="#">Home</a>

      <div class="menu-item">
        <a href="#" class="pill menu-trigger">Timetable</a>
        <div class="dropdown">
          <a href="#">Weekly View</a>
          <a href="#">Room Finder</a>
        </div>
      </div>

      <div class="menu-item">
        <a href="#" class="pill menu-trigger">Exam</a>
        <div class="dropdown">
          <a href="#">Exam Timetable</a>
          <a href="#">Exam Results</a>
          <a href="#">Guidelines</a>
          <a href="#">Performance Analytics</a>
        </div>
      </div>

      <div class="menu-item">
        <a href="#" class="pill menu-trigger">Clubs &amp; Society</a>
        <div class="dropdown">
          <a href="#">USSDC / CPD</a>
          <a href="#">UTAR CARE</a>
          <a href="#">UTAR LEAD</a>
          <a href="#">UTAR TALENT</a>
          <a href="#">Club &amp; Society Announcements</a>
        </div>
      </div>
    </nav>
  </header>

  <!-- ===== Glass Main Panel ===== -->
  <main class="glass" role="main">
    <h1 class="greeting" id="welcome">Hello</h1>
    <p class="desc" id="welcomeSub">This is a static demonstration dashboard. No real data is shown.</p>

    <!-- 2-col grid; cards will wrap nicely -->
    <section class="grid" aria-label="Dashboard">

      <!-- Quick Access -->
      <article class="card" aria-labelledby="qa-title">
        <h2 id="qa-title">Quick Access</h2>
        <div class="links">
          <a href="#">WBLE</a>
          <a href="#">WBLE 2.0</a>
          <a href="#">UTAR Official Page</a>
          <a href="#">UTAR Mailmaster</a>
          <a href="#">UTAR Library</a>
        </div>
      </article>

      <!-- University Announcements -->
      <article class="card" aria-labelledby="ann-title">
        <h2 id="ann-title">University Announcements</h2>
        <ul id="annList" style="margin:0; padding-left:18px;">
          <!-- populated by JS -->
        </ul>
      </article>

      <!-- Current Subjects -->
      <article class="card" aria-labelledby="subs-title">
        <h2 id="subs-title">Current Subjects</h2>
        <table class="table" id="subjectTable">
          <thead><tr><th>Code</th><th>Subject</th><th>Units</th><th>WBLE</th></tr></thead>
          <tbody></tbody>
        </table>
      </article>

      <!-- Next Class + Semester Progress -->
      <article class="card" aria-labelledby="next-title">
        <h2 id="next-title">Next Class &amp; Semester</h2>
        <div class="snapshot">
          <div>
            <span>Next class</span>
            <strong id="nextClass">â€”</strong>
          </div>
          <div>
            <span>Starts in</span>
            <strong id="nextCountdown">â€”</strong>
          </div>
          <div>
            <span>Semester</span>
            <strong id="semText">Y2 â€¢ S1</strong>
          </div>
          <div>
            <span>Progress</span>
            <strong><span id="weekNow">â€”</span> / <span id="weekTotal">14</span> weeks</strong>
          </div>
        </div>
        <div id="progressBar" style="height:8px;border:1px solid #efeff2;border-radius:8px;overflow:hidden;margin-top:8px;">
          <div id="progressFill" style="height:100%;width:0%;background:linear-gradient(90deg,#2a66ff,#0e2f86);"></div>
        </div>
      </article>

      <!-- Upcoming Exams -->
      <article class="card" aria-labelledby="exams-title">
        <h2 id="exams-title">Upcoming Exams</h2>
        <table class="table" id="examTable">
          <thead><tr><th>Date</th><th>Course</th><th>Venue</th></tr></thead>
          <tbody></tbody>
        </table>
        <a class="more" href="#">View full schedule â†’</a>
      </article>

      <!-- Fees & Payments -->
      <article class="card" aria-labelledby="fees-title">
        <h2 id="fees-title">Fees &amp; Payments</h2>
        <div class="snapshot">
          <div><span>Outstanding Balance</span><strong id="feeBalance">RM 0.00</strong></div>
          <div><span>Last Invoice</span><strong id="lastInvoice">â€”</strong></div>
        </div>
        <a class="more" href="#">Open finance portal â†’</a>
      </article>

      <!-- GPA Trend (static sparkline) -->
      <article class="card" aria-labelledby="gpa-title">
        <h2 id="gpa-title">GPA Trend</h2>
        <div style="display:grid;row-gap:8px">
          <div class="snapshot" style="margin-top:0">
            <div><span>Current CGPA</span><strong id="cgpaNow">3.67</strong></div>
            <div><span>Target</span><strong>â‰¥ 3.70</strong></div>
          </div>
          <!-- Simple inline sparkline -->
          <svg viewBox="0 0 200 48" width="100%" height="48" aria-hidden="true">
            <polyline fill="none" stroke="#2a66ff" stroke-width="2"
              points="0,30 25,26 50,28 75,22 100,20 125,18 150,16 175,18 200,15"/>
            <circle cx="200" cy="15" r="3" fill="#0e2f86"/>
          </svg>
          <small style="color:#6e6e73">Sem 1 â†’ Sem 8</small>
        </div>
      </article>

      <!-- Messages / Notifications -->
      <article class="card" aria-labelledby="msg-title">
        <h2 id="msg-title">Messages</h2>
        <ul id="msgList" style="margin:0; padding-left:18px;">
          <!-- populated by JS -->
        </ul>
        <a class="more" href="#">Open Mailmaster â†’</a>
      </article>

      <!-- Student Snapshot (kept from your original) -->
      <article class="card" aria-labelledby="snap-title">
        <h2 id="snap-title">Student Snapshot</h2>
        <div class="snapshot">
          <div><span>Programme</span><strong>BSc (Hons) Computer Science</strong></div>
          <div><span>Year / Sem</span><strong>Y2 â€¢ S1</strong></div>
          <div><span>CGPA</span><strong id="cgpaMini">3.67</strong></div>
          <div><span>Credits In Progress</span><strong>18</strong></div>
        </div>
        <a class="more" href="#">Open profile â†’</a>
      </article>

    </section>
  </main>

  <!-- ===== Footer Chip ===== -->
  <footer class="footer-chip" role="contentinfo">
    Â© 2025 Universiti Tunku Abdul Rahman â€” Demo only
    <br>
    <small>Demo only â€” Universiti Tunku Abdul Rahman is not affiliated with this personal project.</small>
  </footer>

  <!-- ===== Scripts ===== -->
  <script src="assets/js/main.js"></script>
  <script>
    // ---------- Dashboard-only mock data ----------
    const SUBJECTS = [
      { code:'UCCD2513', name:'Data Structures', units:3, wble:'#' },
      { code:'UCCD2223', name:'Web Engineering', units:3, wble:'#' },
      { code:'UCCD2123', name:'Discrete Math',  units:3, wble:'#' },
      { code:'UCCD2333', name:'Operating Systems', units:3, wble:'#' },
      { code:'UCCD2412', name:'IT Ethics', units:2, wble:'#' },
    ];

    const EXAMS = [
      { date: '28 Oct, 9:00', course: 'UCCD2513 Data Structures', venue: 'KB A-201' },
      { date: '31 Oct, 2:00', course: 'UCCD2223 Web Engineering', venue: 'KB C-105' },
      { date: '04 Nov, 9:00', course: 'UCCD2123 Discrete Math',   venue: 'KB Hall' },
    ];

    const ANNOUNCEMENTS = [
      'ðŸ“¢ Final exam timetable has been published.',
      'ðŸ› ï¸ Library catalogue maintenance on Sat 8â€“10pm.',
      'ðŸŽ“ Career fair registration closes this Friday.',
    ];

    const MESSAGES = [
      'Advisor: Reminder to submit FYP topic proposal.',
      'Bursary: Your latest invoice is available.',
      'Sports Complex: Gym will be closed on Deepavali.',
    ];

    // Mock timetable for "next class"
    const TIMETABLE = [
      // today & near-future slots (24h time)
      { dow: 1, time: '10:00', code:'UCCD2513', name:'Data Structures', venue:'KB A-201' },
      { dow: 2, time: '14:00', code:'UCCD2223', name:'Web Engineering', venue:'KB C-105' },
      { dow: 4, time: '09:00', code:'UCCD2123', name:'Discrete Math',   venue:'KB Hall'  },
    ];
    const SEMESTER = { start: '2025-09-02', weeks: 14, text: 'Y2 â€¢ S1' };
    const FEES = { balance: 0, lastInvoice: '2025-09-01' };
    const CGPA = 3.67;

    // ---------- Populate subjects ----------
    (function(){
      const tb = document.querySelector('#subjectTable tbody');
      if (!tb) return;
      tb.innerHTML = SUBJECTS.map(s => `
        <tr>
          <td>${s.code}</td>
          <td>${s.name}</td>
          <td>${s.units}</td>
          <td><a href="${s.wble}">Open</a></td>
        </tr>
      `).join('');
    })();

    // ---------- Populate exams ----------
    (function(){
      const tb = document.querySelector('#examTable tbody');
      if (!tb) return;
      tb.innerHTML = EXAMS.map(e => `<tr><td>${e.date}</td><td>${e.course}</td><td>${e.venue}</td></tr>`).join('');
    })();

    // ---------- Announcements / Messages ----------
    (function(){
      const ann = document.getElementById('annList');
      const msg = document.getElementById('msgList');
      if (ann) ann.innerHTML = ANNOUNCEMENTS.map(a=>`<li>${a}</li>`).join('');
      if (msg) msg.innerHTML = MESSAGES.map(m=>`<li>${m}</li>`).join('');
    })();

    // ---------- Fees & CGPA ----------
    (function(){
      const f = document.getElementById('feeBalance');
      const i = document.getElementById('lastInvoice');
      const c1 = document.getElementById('cgpaNow');
      const c2 = document.getElementById('cgpaMini');
      if (f) f.textContent = `RM ${FEES.balance.toFixed(2)}`;
      if (i) i.textContent = FEES.lastInvoice;
      if (c1) c1.textContent = CGPA.toFixed(2);
      if (c2) c2.textContent = CGPA.toFixed(2);
      document.getElementById('semText')?.textContent = SEMESTER.text;
      document.getElementById('weekTotal')?.textContent = SEMESTER.weeks;
    })();

    // ---------- Next class + countdown + semester progress ----------
    (function(){
      const now = new Date();
      const todayDow = now.getDay(); // 0=Sun ... 6=Sat
      function parseTime(str){ const [h,m]=str.split(':').map(Number); const d=new Date(); d.setHours(h,m,0,0); return d; }

      // find the next class within TIMETABLE (rolling across the week)
      let next = null;
      for (let k=0; k<7; k++){
        const dow = (todayDow + k) % 7;
        const sameDay = TIMETABLE.filter(t => t.dow === dow)
          .map(t => ({...t, when: (()=>{ const d=new Date(now); d.setDate(now.getDate()+k); const tt=parseTime(t.time); d.setHours(tt.getHours(), tt.getMinutes(), 0, 0); return d; })() }))
          .filter(x => x.when > now);
        if (sameDay.length){ next = sameDay.sort((a,b)=>a.when-b.when)[0]; break; }
      }

      const elInfo = document.getElementById('nextClass');
      const elCd   = document.getElementById('nextCountdown');
      if (next && elInfo && elCd){
        elInfo.textContent = `${next.code} ${next.name} @ ${next.time}, ${next.venue}`;

        function tick(){
          const diff = next.when - new Date();
          if (diff <= 0){ elCd.textContent = 'now'; return; }
          const h = Math.floor(diff/3_600_000);
          const m = Math.floor((diff%3_600_000)/60_000);
          elCd.textContent = h ? `${h}h ${m}m` : `${m}m`;
          requestAnimationFrame(()=>setTimeout(tick, 30_000)); // refresh ~30s
        }
        tick();
      } else {
        if (elInfo) elInfo.textContent = 'No classes soon';
        if (elCd)   elCd.textContent   = 'â€”';
      }

      // semester progress
      const start = new Date(SEMESTER.start + 'T00:00:00');
      const weeks = SEMESTER.weeks;
      const msPerWeek = 7*24*3600*1000;
      const wNow = Math.min(weeks, Math.max(0, Math.ceil((now - start) / msPerWeek)));
      document.getElementById('weekNow')?.replaceChildren(document.createTextNode(String(wNow)));
      const pct = Math.max(0, Math.min(100, (wNow/weeks)*100));
      const fill = document.getElementById('progressFill'); if (fill) fill.style.width = pct.toFixed(1) + '%';
    })();

    // ---------- Minor niceties ----------
    // Clear bell badge when clicked
    document.addEventListener('click', (e) => {
      if (!e.target.closest('.icon-btn.bell')) return;
      const b = document.getElementById('notifBadge'); if (b) b.textContent = '';
    });

    // Friendlier welcome subline
    (function(){
      const sub = document.getElementById('welcomeSub');
      if (!sub) return;
      const hour = new Date().getHours();
      const fx = hour<12?'morning':hour<18?'afternoon':'evening';
      sub.textContent = `Good ${fx}! Hereâ€™s your snapshot for the week.`;
    })();
  </script>
</body>
</html>
